<!DOCTYPE html>
{% include "header.html" %}
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Home</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/newuser">user(s)</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">admin</a>
      </li>
    </ul>
    <a class="nav-link" href="/logout">logout</a>
</nav>


<body>
<form action="/save" method="post">
<input type="text" placeholder="Title" name="Title" value="{{ request.form.Title }}">
</form>
    {{ bootstrap.load_js() }}
    <div id="editor"></div>
    <button onclick="save()">save</button>
    <button>publish</button>

    <script>
        const options = {
            debug: 'info',
            modules: {
                toolbar: true,
            },
            placeholder: 'Compose an epic...',
            theme: 'snow'
        };
        const container = document.getElementById('editor');
        const quill = new Quill(container, options);
    </script>
    <script>
        function save() {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/save");
            xhr.setRequestHeader("Content-Type", "application/json; charset=UTF-8");
            const body = {
                body: quill.getSemanticHTML()
            }
            xhr.onload = () => {
            if (xhr.readyState == 4 && xhr.status == 201) {
                console.log(JSON.parse(xhr.responseText));
            } else {
                if(xhr.status == 200) {
                    console.log("200 - OK");
                } else {
                    console.log("error status "+xhr.status);
                }
            }
            };
		{% set count = namespace(value= request.form.Title) %}
            xhr.send(JSON.stringify(body));
	


        }

   
    </script>
<p class="Username"><strong>Username:</strong> {{ username }} 
      <h1></h1>
	<table>
	<tr>
	{% set count = namespace(value=0) %}
	{% set count2 = namespace(value=0) %}
	{% for header in headings %}
	<th> {{ header }} </th>
	{% endfor %}
	</tr>
	{% for row in data %}
	<tr>
	{% for cell in row %}
	{% if count.value % 2 == 0 %}
	
	<td> {{ cell }} </td>

	{% else %}
	{% set count2.value = count2.value + 1 %}
	<form action="/editPost" method="post">
	<input type="hidden" id="index" name="index" value="{{ count2.value }}">
    	<td> <input class="btn btn-default" type="submit" value="{{ cell }}"> </td>
	</form>
	{% endif %}
	
	{% set count.value = count.value + 1 %}
	{% endfor %}
	
	</tr>
	{% endfor %}

	</table>
      <br>
     
</form>

</body>
{% include "footer.html" %}
